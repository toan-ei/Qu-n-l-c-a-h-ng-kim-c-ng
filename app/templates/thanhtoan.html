{% extends "base.html" %}
{% load static %}
{% load humanize %}
{% block title %}Thanh Toán{% endblock %}

{% block thanhtoan %}
<div class="checkout">
    <div class="container">
        <h1>Thông tin đặt hàng</h1>
        <div class="product-info">
            {% for item in order_items %}
            <div class="product">
                <img src="{% static item.image %}" alt="{{ item.product_name }}" class="product-image">
                <div>
                    <p><strong>{{ item.product_name }}</strong></p>
                    <p>Mã: {{ item.product_code|default:"N/A" }}</p>
                    <p>Giá: <strong>{{ item.product_price|intcomma }} VNĐ</strong></p>
                    <label>Số lượng:
                        <input type="number" value="{{ item.quantity }}" min="1" readonly>
                    </label>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="summary">
            <p><strong>Tổng tiền: <span id="total-price">{{ total_price|intcomma }} VNĐ</span></strong></p>
        </div>

        <form id="payment-form" method="post" action="{% url 'checkout_submit' %}">
            {% csrf_token %}
            <h2>Thông tin người mua</h2>
            <label>
                <input type="radio" name="gender" value="Anh" checked> Anh
                <input type="radio" name="gender" value="Chị"> Chị
            </label>
            <input type="text" name="full_name" placeholder="Họ và tên" required>
            <input type="text" name="phone_number" placeholder="Số điện thoại" required>
            <input type="email" name="email" placeholder="Email">
            <input type="date" name="birth_date">

            <h2>Hình thức nhận hàng</h2>
            <label>
                <input type="radio" name="delivery_method" value="delivery" checked> Giao hàng tận nơi
            </label>
            <label>
                <input type="radio" name="delivery_method" value="pickup"> Nhận tại cửa hàng
            </label>

            <select name="province" required>
                <option value="" disabled selected>Chọn tỉnh/thành</option>
                <option value="hcm">TP. Hồ Chí Minh</option>
                <option value="hn">Hà Nội</option>
            </select>
            <input type="text" name="address" placeholder="Địa chỉ cụ thể">

            <h2>Phương thức thanh toán</h2>
            <label>
                <input type="radio" name="payment_method" value="cod" checked> Thanh toán tiền mặt khi nhận hàng (COD)
            </label>

            <textarea name="notes" placeholder="Ghi chú đơn hàng"></textarea>
            <button type="submit">Đặt hàng</button>
        </form>
    </div>
</div>

{% endblock %}
